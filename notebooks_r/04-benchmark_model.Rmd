---
jupyter:
  jupytext:
    formats: notebooks///ipynb,notebooks_r///Rmd
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.11.4
  kernelspec:
    display_name: Deep Learning Forecasting
    language: python
    name: bikemi_win
---

# Import Libraries and Load Data

```{python}
import pandas as pd
```

We use `squeeze=True` to indicate that our data has only one column and we want to retrieve a `pandas.Series` (see [here](https://machinelearningmastery.com/load-explore-time-series-data-python/))

```{python}
daily_rentals = pd.read_csv(
    "../data/bikemi_csv/daily_outflow.csv",
    index_col=[0],
    parse_dates=[0],
    squeeze=True
).asfreq(freq='D')

print(f"Our data is a {type(daily_rentals)}")

daily_rentals
```

We also need to make sure our index has a frequency - which we did with `.asfreq("D")` above:

```{python}
daily_rentals.index
```

# Naive forecaster


We need to establish a benchmark:

```{python}
from sktime.forecasting.base import ForecastingHorizon
from sktime.forecasting.model_selection import temporal_train_test_split
from sktime.forecasting.naive import NaiveForecaster
from sktime.performance_metrics.forecasting import mean_absolute_percentage_error
```

We will be using a Seasonal Naive Forecaster (link Hyndman) where the predicted value is the one of the last seasonal value (i.e., 7 days before):

```{python}
y_train, y_test = temporal_train_test_split(daily_rentals)

# uses all of the test set as forecasting horizon
fh = ForecastingHorizon(y_test.index, is_relative=False)

# naive forecaster model definition
naive_forecaster = NaiveForecaster(strategy="last", sp=7)  # weekly seasonal periodicity

# naive forecaster model fitting
naive_forecaster.fit(y_train)

# naive forecaster predictions
y_pred = naive_forecaster.predict(fh)

# naive forecaster error
mean_absolute_percentage_error(y_test, y_pred)
```

Our model has 64% MAPE


* [This](https://www.sciencedirect.com/science/article/pii/S0169207000000674) Explains well how auto models are used
* [Theta-forecaster](https://www.sciencedirect.com/science/article/pii/S0169207000000662) Exploits seasonal patterns
